<!DOCTYPE html>


<html lang="en" class="light-style layout-menu-fixed" dir="ltr" data-theme="theme-default" data-assets-path="../assets/"
    data-template="vertical-menu-template-free">

<head>
    <meta charset="utf-8" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />

    <title>Dashboard Analytics</title>

    <meta name="description" content="" />



    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="stylesheet" href="../assets/css/table.css" />

    <link
        href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
        rel="stylesheet" />

    <!-- Icons. Uncomment required icon fonts -->
    <link rel="stylesheet" href="../assets/vendor/fonts/boxicons.css" />

    <!-- Core CSS -->
    <link rel="stylesheet" href="../assets/vendor/css/core.css" class="template-customizer-core-css" />
    <link rel="stylesheet" href="../assets/vendor/css/theme-default.css" class="template-customizer-theme-css" />
    <link rel="stylesheet" href="../assets/css/demo.css" />
    <!--js pdf-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>

    <!-- Vendors CSS -->
    <link rel="stylesheet" href="../assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css" />

    <link rel="stylesheet" href="../assets/vendor/libs/apex-charts/apex-charts.css" />

    <!-- Page CSS -->

    <!-- Helpers -->
    <script src="../assets/vendor/js/helpers.js"></script>

    <!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
    <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
    <script src="../assets/js/config.js"></script>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
        }

        .calculated-value {
            min-width: 100px;
            display: inline-block;
            padding: 4px 8px;
        }

        .ratio-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 8px 0;
            padding: 8px;
            border-bottom: 1px solid #eee;
        }

        .ratio-group div:first-child {
            flex: 1;
            min-width: 400px;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        input {
            width: 120px;
            text-align: right;
            padding: 4px;
        }

        .calculated {
            background-color: #f8f9fa;
            font-weight: bold;
        }

        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }

        h2 {
            background-color: #f2f2f2;
            padding: 8px;
            border-left: 5px solid #4CAF50;
            font-size: 18px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 25px;
        }

        th,
        td {
            padding: 10px;

            vertical-align: top;
        }


        td:last-child {
            text-align: right;
            font-weight: bold;
            color: #333;
        }

        .category {
            background-color: #e9e9e9;
            font-weight: bold;
            text-align: left;
        }

        .calculated-value {
            min-width: 100px;
            display: inline-block;
            padding: 4px 8px;
        }

        .ratio-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 8px 0;
            padding: 8px;
            border-bottom: 1px solid #eee;
        }

        .ratio-group div:first-child {
            flex: 1;
            min-width: 400px;
        }

        #assistantBox {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 400px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.25);
            /* translucent white */
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(15px);
            /* Glass blur effect */
            -webkit-backdrop-filter: blur(15px);
            /* Safari */
            display: none;
            z-index: 9999;
            text-align: center;
            animation: fadeIn 0.6s ease-in-out;
        }

        #overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.3);
            /* semi-transparent dark navy */
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            display: none;
            z-index: 9990;
        }
    </style>
</head>

<body>
    <!-- Layout wrapper -->
    <div class="layout-wrapper layout-content-navbar">
        <div class="layout-container">
            <!-- Menu -->

            <aside id="layout-menu" class="layout-menu menu-vertical menu bg-menu-theme">
                <div class="app-brand demo">
                    <a href="index.html" class="app-brand-link">
                        <span class="app-brand-logo demo">

                        </span>
                        <span class="app-brand-text demo menu-text fw-bolder ms-2">
                            ratio-wise</span>
                    </a>

                    <a href="javascript:void(0);"
                        class="layout-menu-toggle menu-link text-large ms-auto d-block d-xl-none">
                        <i class="bx bx-chevron-left bx-sm align-middle"></i>
                    </a>
                </div>

                <div class="menu-inner-shadow"></div>

                <ul class="menu-inner py-1">
                    <!-- Dashboard -->
                    <li class="menu-item ">
                        <a href="index.html" class="menu-link">
                            <i class="menu-icon tf-icons bx bx-home-circle"></i>
                            <div data-i18n="Analytics">Dashboard</div>
                        </a>
                    </li>

                    <!-- Layouts -->

                    <li class="menu-header small text-uppercase">
                        <span class="menu-header-text">Pages</span>
                    </li>

                    <li class="menu-item">
                        <a href="javascript:void(0);" class="menu-link menu-toggle">
                            <i class="menu-icon tf-icons bx bx-lock-open-alt"></i>
                            <div data-i18n="Authentications">Authentications</div>
                        </a>
                        <ul class="menu-sub">
                            <li class="menu-item">
                                <a href="../index.html" class="menu-link" target="_blank">
                                    <div data-i18n="Basic">Login</div>
                                </a>
                            </li>
                            <li class="menu-item">
                                <a href="auth-register-basic.html" class="menu-link" target="_blank">
                                    <div data-i18n="Basic">Register</div>
                                </a>
                            </li>
                            <li class="menu-item">
                                <a href="auth-forgot-password-basic.html" class="menu-link" target="_blank">
                                    <div data-i18n="Basic">Forgot Password</div>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="menu-item active">
                        <a href="javascript:void(0);" class="menu-link menu-toggle">
                            <i class="menu-icon tf-icons bx bx-lock-open-alt"></i>
                            <div data-i18n="Authentications">Table</Table>
                            </div>
                        </a>
                        <ul class="menu-sub">
                            <li class="menu-item active">
                                <a href="BILAN_FONCTIONNEL.html" class="menu-link">
                                    <div data-i18n="Basic">BILAN FONCTIONNEL</div>
                                </a>
                            </li>
                            <li class="menu-item">
                                <a href="table2.html" class="menu-link">
                                    <div data-i18n="Basic">Le compte de r√©sultats et la caf</div>
                                </a>
                            </li>

                        </ul>
                    </li>
                    <!-- end auth -->
                </ul>
            </aside>
            <!-- / Menu -->

            <!-- Layout container -->
            <div class="layout-page">
                <!-- Navbar -->



                <!-- Content wrapper -->
                <div class="d-flex justify-content-center mt-5">
                    <div style="max-width: 1000px; width: 100%;">
                        <!--table2//////////////////////////////////////////////////-->
                        <div class="d-flex justify-content-center mt-5">
                            <div style="max-width: 1000px; width: 100%;">
                                <h1>Le compte de r√©sultats et la caf</h1>


                            </div>
                        </div>


                        <style>
                            .financial-ratios-table {
                                width: 100%;
                                border-collapse: collapse;
                                font-family: Arial, sans-serif;
                                margin: 20px 0;
                            }

                            .financial-ratios-table td {
                                padding: 10px 15px;
                                border-bottom: 1px solid #e0e0e0;
                            }

                            .section-header {
                                background-color: #f5f5f5;
                                font-weight: bold;
                                font-size: 1.1em;
                            }

                            .section-header td {
                                padding: 12px 15px;
                                border-bottom: 2px solid #ddd;
                            }

                            .ratio-label {
                                font-weight: 500;
                                color: #333;
                                width: 40%;
                            }

                            .ratio-formula {
                                color: #666;
                                font-size: 0.9em;
                                width: 35%;
                            }

                            .ratio-value {
                                text-align: right;
                                width: 25%;
                            }

                            .ratio-value input {
                                width: 100%;
                                padding: 6px 8px;
                                border: 1px solid #ddd;
                                border-radius: 4px;
                                text-align: right;
                            }

                            .spacer-row td {
                                padding: 8px 0;
                                border: none;
                            }

                            #submitBtn {
                                font-size: 18px;
                                padding: 14px 30px;
                                border-radius: 50px;
                                background: linear-gradient(to right, #3b82f6, #60a5fa);
                                /* blue gradient */
                                border: none;
                                color: white;
                                box-shadow: 0 0 15px rgba(59, 130, 246, 0.3);
                                transition: all 0.3s ease;
                            }

                            #submitBtn:hover {
                                transform: translateY(-2px);
                                box-shadow: 0 0 25px rgba(96, 165, 250, 0.4);
                            }

                            /* Floating Assistant */
                            #assistantBox {
                                position: fixed;
                                top: 50%;
                                left: 50%;
                                transform: translate(-50%, -50%);
                                width: 400px;
                                padding: 30px;
                                background: #ffffff;
                                border-radius: 20px;
                                border: 2px solid #3b82f6;
                                box-shadow: 0 10px 25px rgba(59, 130, 246, 0.2);
                                display: none;
                                z-index: 9999;
                                text-align: center;
                                animation: fadeIn 0.6s ease-in-out;
                            }

                            #assistantBox img {
                                width: 120px;
                                margin-bottom: 20px;
                            }

                            .robot-image img {
                                width: 120px;
                                margin-bottom: 10px;
                            }

                            .message-box {
                                min-height: 50px;
                                /* Fix the height to prevent robot jumping */
                                margin-bottom: 10px;
                                position: relative;
                            }

                            .typewriter-text {
                                display: inline-block;
                                font-size: 16px;
                                font-weight: 500;
                                color: #1e3a8a;
                                border-right: 2px solid #3b82f6;
                                white-space: normal;
                                overflow: hidden;
                                width: 0;
                                animation: typing 3.5s steps(60, end) forwards, blink 0.8s infinite;
                            }

                            @keyframes typing {
                                to {
                                    width: 100%;
                                }
                            }

                            @keyframes blink {

                                0%,
                                100% {
                                    border-color: transparent;
                                }

                                50% {
                                    border-color: #3b82f6;
                                }
                            }


                            .glow-spinner {
                                margin-top: 20px;
                                width: 40px;
                                height: 40px;
                                border: 4px solid transparent;
                                border-top: 4px solid #3b82f6;
                                border-radius: 50%;
                                animation: spin 1s linear infinite;
                                box-shadow: 0 0 10px #3b82f6;
                                margin-left: auto;
                                margin-right: auto;
                            }

                            @keyframes spin {
                                to {
                                    transform: rotate(360deg);
                                }
                            }

                            @keyframes fadeIn {
                                from {
                                    opacity: 0;
                                    transform: translate(-50%, -60%);
                                }

                                to {
                                    opacity: 1;
                                    transform: translate(-50%, -50%);
                                }
                            }
                        </style>

                        <table>
                            <thead>
                                <tr>
                                    <th>Intitul√©</th>
                                    <th>VARIATIONS</th>
                                    <th>N</th>
                                    <th>N-1</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Rows with inputs -->
                                <tr>
                                    <td>Chiffre d'affaires</td>
                                    <td id="var_ca" class="calculated">0,00</td>
                                    <td><input type="text" id="n_ca" value="0"></td>
                                    <td><input type="text" id="n1_ca" value="0"></td>
                                </tr>
                                <tr>
                                    <td>Variation stocks produits finis et en cours</td>
                                    <td id="var_stock" class="calculated">0,00</td>
                                    <td><input type="text" id="n_stock" value="0"></td>
                                    <td><input type="text" id="n1_stock" value="0"></td>
                                </tr>
                                <tr>
                                    <td>Production immobilis√©e</td>
                                    <td id="Production_immobilis" class="calculated">0,00</td>
                                    <td><input type="text" id="n_immobilis" value="0"></td>
                                    <td><input type="text" id="n1_immobilis" value="0"></td>
                                </tr>
                                <tr>
                                    <td>Subventions d‚Äôexploitation</td>
                                    <td id="Subventions_exploitation" class="calculated">0,00</td>
                                    <td><input type="text" id="n_exploitation" value="0"></td>
                                    <td><input type="text" id="n1_exploitation" value="0"></td>
                                </tr>
                                <tr>
                                    <td>PRODUCTION DE L‚ÄôEXERCICE</td>
                                    <td id="PRODUCTION_DE_L_EXERCICE" class="calculated">0,00</td>
                                    <td style="background-color:rgb(208, 224, 252);" id="n_PRODUCTION_DE_L_EXERCICE"
                                        value="0"></td>
                                    <td style="background-color:rgb(208, 224, 252);" id="n1_PRODUCTION_DE_L_EXERCICE"
                                        value="0"></td>
                                </tr>
                                <tr>
                                    <td>Achats consomm√©s</td>
                                    <td id="ACHATS_CONSOMMES" class="calculated">0,00</td>
                                    <td><input type="text" id="n_ACHATS_CONSOMMES" value="0"></td>
                                    <td><input type="text" id="n1_ACHATS_CONSOMMES" value="0"></td>
                                </tr>
                                <tr>
                                    <td>Services ext√©rieurs et autres consommations</td>
                                    <td id="SERVICES_AUTRES_CONSOMMATIONS" class="calculated">0,00</td>
                                    <td><input type="text" id="n_SERVICES_AUTRES_CONSOMMATIONS" value="0"></td>
                                    <td><input type="text" id="n1_SERVICES_AUTRES_CONSOMMATIONS" value="0"></td>
                                </tr>
                                <tr>
                                    <td>II ‚Äì CONSOMMATION DE L‚ÄôEXERCICE</td>
                                    <td id="CONSOMMATION_EXERCICE" class="calculated">0,00</td>
                                    <td style="background-color:rgb(208, 224, 252);"
                                            id="n_CONSOMMATION_EXERCICE" value="0"></td>
                                    <td style="background-color:rgb(208, 224, 252);"
                                            id="n1_CONSOMMATION_EXERCICE" value="0"></td>
                                </tr>
                                <tr>
                                    <td>III VALEUR AJOUTEE D‚ÄôEXPLOITATION (I - II)</td>
                                    <td id="VALEUR_AJOUTEE_EXPLOITATION" class="calculated">0,00</td>
                                    <td style="background-color:rgb(208, 224, 252);"
                                            id="n_VALEUR_AJOUTEE_EXPLOITATION" value="0"></td>
                                    <td style="background-color:rgb(208, 224, 252);"
                                            id="n1_VALEUR_AJOUTEE_EXPLOITATION" value="0"></td>
                                </tr>
                                <tr>
                                    <td>Charges de personnel</td>
                                    <td id="CHARGES_PERSONNEL" class="calculated">0,00</td>
                                    <td><input type="text" id="n_CHARGES_PERSONNEL" value="0"></td>
                                    <td><input type="text" id="n1_CHARGES_PERSONNEL" value="0"></td>
                                </tr>
                                <tr>
                                    <td>Imp√¥ts, taxes et versements assimil√©s</td>
                                    <td id="IMPOTS_TAXES" class="calculated">0,00</td>
                                    <td><input type="text" id="n_IMPOTS_TAXES" value="0"></td>
                                    <td><input type="text" id="n1_IMPOTS_TAXES" value="0"></td>
                                </tr>
                                <tr>
                                    <td>IV EXCEDENT BRUT D‚ÄôEXPLOITATION</td>
                                    <td id="EXCEDENT_BRUT_EXPLOITATION" class="calculated">0,00</td>
                                    <td style="background-color:rgb(208, 224, 252);"
                                            id="n_EXCEDENT_BRUT_EXPLOITATION" value="0"></td>
                                    <td style="background-color:rgb(208, 224, 252);"
                                            id="n1_EXCEDENT_BRUT_EXPLOITATION" value="0"></td>
                                </tr>
                                <tr>
                                    <td>Autres produits op√©rationnels</td>
                                    <td id="AUTRES_PRODUITS_OPERATIONNELS" class="calculated">0,00</td>
                                    <td><input type="text" id="n_AUTRES_PRODUITS_OPERATIONNELS" value="0"></td>
                                    <td><input type="text" id="n1_AUTRES_PRODUITS_OPERATIONNELS" value="0"></td>
                                </tr>
                                <tr>
                                    <td>Autres charges op√©rationnelles</td>
                                    <td id="AUTRES_CHARGES_OPERATIONNELLES" class="calculated">0,00</td>
                                    <td><input type="text" id="n_AUTRES_CHARGES_OPERATIONNELLES" value="0"></td>
                                    <td><input type="text" id="n1_AUTRES_CHARGES_OPERATIONNELLES" value="0"></td>
                                </tr>

                                <tr>
                                    <td>Dotations aux amortissements et aux provisions</td>
                                    <td id="DOTATIONS" class="calculated">0,00</td>
                                    <td><input type="text" id="n_DOTATIONS" value="0"></td>
                                    <td><input type="text" id="n1_DOTATIONS" value="0"></td>
                                </tr>
                                <tr>
                                    <td>Reprise sur pertes de valeur et provisions</td>
                                    <td id="REPRISES" class="calculated">0,00</td>
                                    <td><input type="text" id="n_REPRISES" value="0"></td>
                                    <td><input type="text" id="n1_REPRISES" value="0"></td>
                                </tr>
                                <tr>
                                    <td>V RESULTAT OPERATIONNEL</td>
                                    <td id="RESULTAT_OPERATIONNEL" class="calculated">0,00</td>
                                    <td style="background-color:rgb(208, 224, 252);"
                                            id="n_RESULTAT_OPERATIONNEL" value="0"></td>
                                    <td style="background-color:rgb(208, 224, 252);"
                                            id="n1_RESULTAT_OPERATIONNEL" value="0"></td>
                                </tr>
                                <tr>
                                    <td>Produits financiers</td>
                                    <td id="PRODUITS_FINANCIERS" class="calculated">0,00</td>
                                    <td><input type="text" id="n_PRODUITS_FINANCIERS" value="0"></td>
                                    <td><input type="text" id="n1_PRODUITS_FINANCIERS" value="0"></td>
                                </tr>
                                <tr>
                                    <td>Charges financi√®res</td>
                                    <td id="CHARGES_FINANCIERES" class="calculated">0,00</td>
                                    <td><input type="text" id="n_CHARGES_FINANCIERES" value="0"></td>
                                    <td><input type="text" id="n1_CHARGES_FINANCIERES" value="0"></td>
                                </tr>
                                <tr>
                                    <td>VI RESULTAT FINANCIER</td>
                                    <td id="RESULTAT_FINANCIER" class="calculated">0,00</td>
                                    <td style="background-color:rgb(208, 224, 252);"
                                            id="n_RESULTAT_FINANCIER" value="0"></td>
                                    <td style="background-color:rgb(208, 224, 252);"
                                            id="n1_RESULTAT_FINANCIER" value="0"></td>
                                </tr>
                                <tr>
                                    <td>VII RESULTAT ORDINAIRE AVANT IMPOTS (V + VI)</td>
                                    <td id="RESULTAT_ORDINAIRE_AVANT_IMPOTS" class="calculated">0,00</td>
                                    <td style="background-color:rgb(208, 224, 252);"
                                            id="n_RESULTAT_ORDINAIRE_AVANT_IMPOTS" value="0"></td>
                                    <td style="background-color:rgb(208, 224, 252);"
                                            id="n1_RESULTAT_ORDINAIRE_AVANT_IMPOTS" value="0"></td>
                                </tr>
                                <tr>
                                    <td>Imp√¥ts exigibles sur r√©sultats ordinaires</td>
                                    <td id="IMPOTS_EXIGIBLES" class="calculated">0,00</td>
                                    <td id="n_IMPOTS_EXIGIBLES" value="0"></td>
                                    <td id="n1_IMPOTS_EXIGIBLES" value="0"></td>
                                </tr>
                                <tr>
                                    <td>Imp√¥ts diff√©r√©s (Variations) sur r√©sultats ordinaires</td>
                                    <td id="IMPOTS_DIFFERES" class="calculated">0,00</td>
                                    <td><input type="text" id="n_IMPOTS_DIFFERES" value="0"></td>
                                    <td><input type="text" id="n1_IMPOTS_DIFFERES" value="0"></td>
                                </tr>
                                <tr>
                                    <td>TOTAL DES PRODUITS DES ACTIVITES ORDINAIRES</td>
                                    <td id="TOTAL_PRODUITS_ORDINAIRES" class="calculated">0,00</td>
                                    <td type="text" id="n_TOTAL_PRODUITS_ORDINAIRES" value="0"></td>
                                    <td id="n1_TOTAL_PRODUITS_ORDINAIRES" value="0"></td>
                                </tr>
                                <tr>
                                    <td>TOTAL DES CHARGES DES ACTIVITES ORDINAIRES</td>
                                    <td id="TOTAL_CHARGES_ORDINAIRES" class="calculated">0,00</td>
                                    <td id="n_TOTAL_CHARGES_ORDINAIRES" value="0"></td>
                                    <td id="n1_TOTAL_CHARGES_ORDINAIRES" value="0"></td>
                                </tr>

                                <tr>
                                    <td>VIII RESULTAT NET DES ACTIVITES ORDINAIRES</td>
                                    <td id="RESULTAT_NET_ORDINAIRES" class="calculated">0,00</td>
                                    <td style="background-color:rgb(208, 224, 252);"
                                            id="n_RESULTAT_NET_ORDINAIRES" value="0"></td>
                                    <td style="background-color:rgb(208, 224, 252);"
                                            id="n1_RESULTAT_NET_ORDINAIRES" value="0"></td>
                                </tr>
                                <tr>
                                    <td>El√©ments extraordinaires (produits) (√† pr√©ciser)</td>
                                    <td id="EXTRA_PRODUITS" class="calculated">0,00</td>
                                    <td><input type="text" id="n_EXTRA_PRODUITS" value="0"></td>
                                    <td><input type="text" id="n1_EXTRA_PRODUITS" value="0"></td>
                                </tr>
                                <tr>
                                    <td>El√©ments extraordinaires (charges) (√† pr√©ciser)</td>
                                    <td id="EXTRA_CHARGES" class="calculated">0,00</td>
                                    <td><input type="text" id="n_EXTRA_CHARGES" value="0"></td>
                                    <td><input type="text" id="n1_EXTRA_CHARGES" value="0"></td>
                                </tr>
                                <tr>
                                    <td>IX RESULTAT EXTRAORDINAIRE</td>
                                    <td id="RESULTAT_EXTRAORDINAIRE" class="calculated">0,00</td>
                                    <td style="background-color:rgb(208, 224, 252);"
                                            id="n_RESULTAT_EXTRAORDINAIRE" value="0"></td>
                                    <td style="background-color:rgb(208, 224, 252);"
                                            id="n1_RESULTAT_EXTRAORDINAIRE" value="0"></td>
                                </tr>
                                <tr>
                                    <td>X RESULTAT NET DE L‚ÄôEXERCICE</td>
                                    <td id="RESULTAT_NET_EXERCICE" class="calculated">0,00</td>
                                    <td style="background-color:rgb(208, 224, 252);"><input type="text"
                                            id="n_RESULTAT_NET_EXERCICE" value="0"></td>
                                    <td style="background-color:rgb(208, 224, 252);"><input type="text"
                                            id="n1_RESULTAT_NET_EXERCICE" value="0"></td>
                                </tr>


                            </tbody>
                            <table>
                                <h2>Les ratios de mesure de l‚Äôactivit√©</h2>

                                <tr>
                                    <td>√âvolution du CA</td>
                                    <td id="evo_ca">#DIV/0!</td>
                                </tr>
                                <tr>
                                    <td>√âvolution du VA</td>
                                    <td id="evo_va">#DIV/0!</td>
                                </tr>
                                <tr>
                                    <td>√âvolution de la production</td>
                                    <td id="evo_pr">#DIV/0!</td>
                                </tr>
                                <tr>
                                    <td>√âvolution du RNE</td>
                                    <td id="evo_rne">#DIV/0!</td>
                                </tr>
                            </table>

                            <h2>Les ratios de rentabilit√©</h2>
                            <table>
                                <tr>
                                    <td>Taux de marge b√©n√©ficiaire = R√©sultat de l‚Äôexercice / CA HT</td>
                                    <td id="taux_m_ben">0.081</td>
                                </tr>
                                <tr>
                                    <td>Taux de marge brute d‚Äôexploitation = EBE / CA HT</td>
                                    <td id="taux_m_bru">0.205</td>
                                </tr>
                            </table>

                            <h2>Les ratios constatant le partage de la valeur ajout√©e</h2>
                            <table>
                                <tr>
                                    <td>Part des salari√©s = Charges de personnel / VA</td>
                                    <td id="Part_salaries">0.445544554</td>
                                </tr>
                                <tr>
                                    <td>Part de l‚Äô√âtat = Imp√¥ts, taxes et versements assimil√©s / VA</td>
                                    <td id="Part_etat">0.148514851</td>
                                </tr>
                                <tr>
                                    <td>Part de l‚ÄôEBE = EBE / VA</td>
                                    <td id="Part_ebe">0.405940594</td>
                                </tr>
                            </table>

                            <h2>Les ratios constatant le partage de l‚ÄôEBE</h2>
                            <table>
                                <tr>
                                    <td>Part des immobilisations = Dotations amortissements et PV / EBE</td>
                                    <td id="part_imm_par_EBE">1.024390244</td>
                                </tr>
                                <tr>
                                    <td>Part des pr√™teurs = Charges financi√®res / EBE</td>
                                    <td id="part_preteurs">0.390243902</td>
                                </tr>
                                <tr>
                                    <td>Part r√©sultat ordinaire = R√©sultat ordinaire avant imp√¥ts / EBE</td>
                                    <td id="part_result_ordi">0.487804878</td>
                                </tr>
                            </table>

                            <h2>Les ratios suppl√©mentaires</h2>
                            <table>
                                <tr>
                                    <td>Taux d‚Äôint√©gration = VA / CA HT</td>
                                    <td id="taux_integ">0.505</td>
                                </tr>
                            </table>

                            <h2>Les ratios de rentabilit√© (suite)</h2>
                            <table>
                                <tr>
                                    <td>Rentabilit√© des capitaux propres = R√©sultat de l'exercice / Capitaux propres
                                    </td>
                                    <td id="rentabilite_capt_prop"></td>
                                </tr>
                                <tr>
                                    <td>Rentabilit√© des capitaux propres hors √©l√©ments exceptionnels = R√©sultat courant
                                        avant imp√¥ts / Capitaux propres</td>
                                    <td id="rentabilite_capt_prop_hors">0.9456</td>
                                </tr>
                                <tr>
                                    <td>Rentabilit√© √©conomique = (R√©sultat de l'exercice + Charges d'int√©r√™ts) /
                                        Ressources stables</td>
                                    <td id="rentabilite_economique">0.571936057</td>
                                </tr>
                                <tr>
                                    <td>Rentabilit√© brute des ressources stables = EBE / Ressources stables</td>
                                    <td id="rentabilite_brute_ressources_stables">0.728241563</td>
                                </tr>
                            </table>
                        </table>


                        <!--  table 3 -->
                        <div class="no-border" style="font-size: 19px;">
                            Calcul de la capacit√© d'autofinancement de l'exc√©dente brut d'exploitation
                        </div>
                        <table>
                            <tbody>

                                <tr>
                                    <td class="bold-italic" style="font-size: 14px;">d√©signation</td>
                                    <td class="right-align bold-italic" style="font-size: 15px; width: 100px;">montant +
                                    </td>
                                    <td class="right-align bold-italic" style="font-size: 14px; width: 100px;">montant ‚àí
                                    </td>
                                </tr>
                                <tr>
                                    <td class="bold-italic" style="font-size: 14px;">exc√©dente brut d'exploitation</td>
                                    <td><input type="text" id="excedent_brut" placeholder="0,00 DA"
                                            aria-label="Exc√©dent Brut d'Exploitation"></td>
                                    <td class="right-align" style="font-size: 12px;"><input type="text"
                                            id="excedent_brut_neg" placeholder="0,00 DA"
                                            aria-label="Exc√©dent Brut N√©gatif"></td>
                                </tr>
                                <tr>
                                    <td class="italic" style="font-size: 14px;">+ produit d'exploitation sauf compte 752
                                        (75-752)</td>
                                    <td class="right-align" style="font-size: 12px;"><input type="text"
                                            id="produit_exploitation" placeholder="0,00 DA"
                                            aria-label="Produit d'Exploitation"></td>
                                    <td class="right-align" style="font-size: 12px;"><input type="text"
                                            id="produit_exploitation_neg" placeholder="0,00 DA"
                                            aria-label="Produit d'Exploitation N√©gatif"></td>
                                </tr>
                                <tr>
                                    <td class="italic" style="font-size: 14px;">+ produits financiers sauf compte 765 ET
                                        767 (76-765-767)</td>
                                    <td class="right-align" style="font-size: 12px;"><input type="text"
                                            id="produits_financiers" placeholder="0,00 DA"
                                            aria-label="Produits Financiers"></td>
                                    <td class="right-align" style="font-size: 12px;"><input type="text"
                                            id="produits_financiers_neg" placeholder="0,00 DA"
                                            aria-label="Produits Financiers N√©gatif"></td>
                                </tr>
                                <tr>
                                    <td class="italic" style="font-size: 14px;">- charge d'exploitation sauf compte
                                        652(65-652)</td>
                                    <td class="right-align" style="font-size: 12px;"><input type="text"
                                            id="charge_exploitation" placeholder="0,00 DA"
                                            aria-label="Charge d'Exploitation"></td>
                                    <td class="right-align" style="font-size: 12px;"><input type="text"
                                            id="charge_exploitation_neg" placeholder="0,00 DA"
                                            aria-label="Charge d'Exploitation N√©gatif"></td>
                                </tr>
                                <tr>
                                    <td class="italic" style="font-size: 14px;">- charges financiers sauf compte 665 ET
                                        -667 (66-667-665)</td>
                                    <td class="right-align" style="font-size: 12px;"><input type="text"
                                            id="charges_financieres" placeholder="0,00 DA"
                                            aria-label="Charges Financi√®res"></td>
                                    <td class="right-align" style="font-size: 12px;"><input type="text"
                                            id="charges_financieres_neg" placeholder="0,00 DA"
                                            aria-label="Charges Financi√®res N√©gatif"></td>
                                </tr>
                                <tr>
                                    <td class="italic" style="font-size: 14px;">+produits exceptionnels</td>
                                    <td class="right-align" style="font-size: 12px;"><input type="text"
                                            id="produits_exceptionnels" placeholder="0,00 DA"
                                            aria-label="Produits Exceptionnels"></td>
                                    <td class="right-align" style="font-size: 12px;"><input type="text"
                                            id="produits_exceptionnels_neg" placeholder="0,00 DA"
                                            aria-label="Produits Exceptionnels N√©gatif"></td>
                                </tr>
                                <tr>
                                    <td class="italic" style="font-size: 14px;">-charges exceptionnelles</td>
                                    <td class="right-align" style="font-size: 12px;"><input type="text"
                                            id="charges_exceptionnelles" placeholder="0,00 DA"
                                            aria-label="Charges Exceptionnelles"></td>
                                    <td class="right-align" style="font-size: 12px;"><input type="text"
                                            id="charges_exceptionnelles_neg" placeholder="0,00 DA"
                                            aria-label="Charges Exceptionnelles N√©gatif"></td>
                                </tr>
                                <tr>
                                    <td class="italic" style="font-size: 14px;">-participations des salari√©s</td>
                                    <td class="right-align" style="font-size: 12px;"><input type="text"
                                            id="participations_salaries" placeholder="0,00 DA"
                                            aria-label="Participations des Salari√©s"></td>
                                    <td class="right-align" style="font-size: 12px;"><input type="text"
                                            id="participations_salaries_neg" placeholder="0,00 DA"
                                            aria-label="Participations des Salari√©s N√©gatif"></td>
                                </tr>
                                <tr>
                                    <td class="italic" style="font-size: 14px;">- impots sur les b√©n√©fices (69)</td>
                                    <td class="right-align" style="font-size: 12px;"><input type="text"
                                            id="impots_benefices" placeholder="0,00 DA"
                                            aria-label="Imp√¥ts sur les B√©n√©fices"></td>
                                    <td class="right-align" style="font-size: 12px;"><input type="text"
                                            id="impots_benefices_neg" placeholder="0,00 DA"
                                            aria-label="Imp√¥ts sur les B√©n√©fices N√©gatif"></td>
                                </tr>
                                <tr>
                                    <td class="bold-italic" style="font-size: 14px;">TOTAL</td>
                                    <td id="total_positif" class="calculated">0,00</td>
                                    <td id="total_negatif" class="calculated">0,00</td>

                                </tr>
                                <tr>
                                    <td class="bold-italic" style="font-size: 14px;">Calcul de la capacit√©
                                        d'autofinancement de l'exc√©dente brut d'exploitation</td>

                                    <td colspan="2" id="total_cap" class="calculated">0,00</td>
                                </tr>


                            </tbody>
                        </table>
                        <!--table 03-->
                        <div class="financial-table-container">
                            <table class="financial-table">
                                <thead>
                                    <tr>
                                        <th class="designation">D√©signation</th>
                                        <th class="amount">MONTANT +</th>
                                        <th class="amount">MONTANT -</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>R√©sultat net de l'exercice</td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="plus1"
                                                placeholder="0,00 DA" aria-label="R√©sultat net +"></td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="minus1"
                                                placeholder="0,00 DA" aria-label="R√©sultat net -"></td>
                                    </tr>
                                    <tr>
                                        <td>+ Dotations aux amortissements et provisions</td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="plus2"
                                                placeholder="0,00 DA" aria-label="Dotations +"></td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="minus2"
                                                placeholder="0,00 DA" aria-label="Dotations -"></td>
                                    </tr>
                                    <tr>
                                        <td>- Reprises sur pertes de valeur et provisions (78)</td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="plus3"
                                                placeholder="0,00 DA" aria-label="Reprises +"></td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="minus3"
                                                placeholder="0,00 DA" aria-label="Reprises -"></td>
                                    </tr>
                                    <tr>
                                        <td>- Quote-part de subventions vir√©es au r√©sultat de l'exercice</td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="plus4"
                                                placeholder="0,00 DA" aria-label="Subventions +"></td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="minus4"
                                                placeholder="0,00 DA" aria-label="Subventions -"></td>
                                    </tr>
                                    <tr>
                                        <td>+ Moins-value sur cession d'actif immobilis√© (652)</td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="plus5"
                                                placeholder="0,00 DA" aria-label="Moins-value +"></td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="minus5"
                                                placeholder="0,00 DA" aria-label="Moins-value -"></td>
                                    </tr>
                                    <tr>
                                        <td>- Plus-value sur cession d'actif immobilis√© (752)</td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="plus6"
                                                placeholder="0,00 DA" aria-label="Plus-value +"></td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="minus6"
                                                placeholder="0,00 DA" aria-label="Plus-value -"></td>
                                    </tr>
                                    <tr>
                                        <td>+ √âcarts de conversion - passif</td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="plus7"
                                                placeholder="0,00 DA" aria-label="√âcarts passif +"></td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="minus7"
                                                placeholder="0,00 DA" aria-label="√âcarts passif -"></td>
                                    </tr>
                                    <tr>
                                        <td>- √âcarts de r√©√©valuation des actifs (moins-value 665)</td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="plus8"
                                                placeholder="0,00 DA" aria-label="R√©√©valuation moins-value +"></td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="minus8"
                                                placeholder="0,00 DA" aria-label="R√©√©valuation moins-value -"></td>
                                    </tr>
                                    <tr>
                                        <td>- √âcarts de r√©√©valuation des actifs (plus-value 765)</td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="plus9"
                                                placeholder="0,00 DA" aria-label="R√©√©valuation plus-value +"></td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="minus9"
                                                placeholder="0,00 DA" aria-label="R√©√©valuation plus-value -"></td>
                                    </tr>
                                    <tr>
                                        <td>- Pertes nettes sur cession d'actifs (667)</td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="plus10"
                                                placeholder="0,00 DA" aria-label="Pertes cession +"></td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="minus10"
                                                placeholder="0,00 DA" aria-label="Pertes cession -"></td>
                                    </tr>
                                    <tr>
                                        <td>+ B√©n√©fices nets sur cession d'actifs (767)</td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="plus11"
                                                placeholder="0,00 DA" aria-label="B√©n√©fices nets +"></td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text" id="minus11"
                                                placeholder="0,00 DA" aria-label="B√©n√©fices nets -"></td>
                                    </tr>
                                    <tr class="total-row">
                                        <td>TOTAL</td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text"
                                                id="total_plus" placeholder="0,00 DA" readonly></td>
                                        <td class="right-align" style="font-size: 12px;"><input type="text"
                                                id="total_minus" placeholder="0,00 DA" readonly></td>
                                    </tr>
                                </tbody>
                            </table>


                            <div class="caf-calculation">
                                <h3>Calcul de la capacit√© d'autofinancement (CAF)</h3>
                                <div class="caf-result">
                                    <span>CAF = Total + - Total -</span>
                                    <span class="value">calculated</span>
                                </div>

                                <h3>Ratios</h3>
                                <div class="ratio">
                                    <span>Autofinancement = CAF - b√©n√©fices distribu√©s</span>
                                    <span class="value  positive">calculated</span>
                                </div>
                                <div class="ratio">
                                    <span>B√©n√©fices distribu√©s = RNE √ó % de distribution (50%)</span>
                                    <span class="value">calculated</span>
                                </div>
                                <div class="ratio">
                                    <span>Part de la CAF par rapport √† la VA = CAF / VA</span>
                                    <span class="value">calculated6

                                    </span>
                                </div>
                                <div class="ratio">
                                    <span>Capacit√© d'endettement = Dettes financi√®res / CAF</span>
                                    <span class="value">calculated</span>
                                </div>
                            </div>
                        </div>

                        <style>
                            .financial-table-container {
                                font-family: Arial, sans-serif;
                                max-width: 800px;
                                margin: 20px auto;
                                box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
                            }

                            .financial-table {
                                width: 100%;
                                border-collapse: collapse;
                                margin-bottom: 30px;
                            }

                            .financial-table th {
                                background-color: #f5f7fa;
                                padding: 12px 15px;
                                text-align: left;
                                font-weight: bold;
                                border-bottom: 2px solid #e0e0e0;
                            }

                            .financial-table td {
                                padding: 10px 15px;
                                border-bottom: 1px solid #e0e0e0;
                            }

                            .designation {
                                width: 60%;
                            }

                            .amount {
                                width: 20%;
                                text-align: right;
                            }

                            .positive {
                                color: #2e7d32;
                                font-weight: 500;
                            }

                            .negative {
                                color: #c62828;
                                font-weight: 500;
                            }

                            .total-row {
                                background-color: #f5f7fa;
                                font-weight: bold;
                            }

                            .total-row td {
                                border-top: 2px solid #e0e0e0;
                                border-bottom: none;
                            }

                            .caf-calculation {
                                padding: 20px;
                                background-color: #f5f7fa;
                                border-radius: 4px;
                            }

                            .caf-calculation h3 {
                                margin-top: 0;
                                color: #333;
                                border-bottom: 1px solid #e0e0e0;
                                padding-bottom: 8px;
                            }

                            .caf-result,
                            .ratio {
                                display: flex;
                                justify-content: space-between;
                                margin: 12px 0;
                                padding: 8px 0;
                            }

                            .value {
                                font-weight: bold;
                                min-width: 100px;
                                text-align: right;
                            }

                            .caf-result .value {
                                color: #1565c0;
                                font-size: 1.1em;
                            }
                        </style>
                        <div class="d-flex justify-content-center mt-5">

                            <!-- Button -->
                            <button id="submitBtn2">
                                Get Analysis Report
                            </button>
                            <div id="overlay"></div>
                            <!-- AI Assistant Box -->
                            <div id="assistantBox">
                                <!-- Robot image stays fixed -->
                                <div class="robot-image">
                                    <img src="https://cdn-icons-png.flaticon.com/512/4712/4712035.png" alt="AI Robot">
                                </div>

                                <!-- Message box with fixed height to avoid shifting -->
                                <div class="message-box">
                                    <div class="typewriter-text">
                                        <span>Starting AI analysis...</span><br>
                                        <span>Preparing your PDF report...</span>
                                    </div>
                                </div>

                                <div class="glow-spinner"></div>
                            </div>


                            <script>
                                document.getElementById("submitBtn").addEventListener("click", function () {
                                    document.getElementById("overlay").style.display = "block";
                                    document.getElementById("assistantBox").style.display = "block";

                                    setTimeout(() => {
                                        window.location.href = "rapport_financier.pdf   "; // Change to your link
                                    }, 4000);
                                });

                            </script>
                        </div>
                    </div>
                </div>
                <!-- Content wrapper -->
            </div>
            <!-- / Layout page -->
        </div>

        <!-- Overlay -->
        <div class="layout-overlay layout-menu-toggle"></div>
    </div>
    <!-- / Layout wrapper -->



    <!-- Core JS -->
    <!-- build:js assets/vendor/js/core.js -->
    <script src="../assets/vendor/libs/jquery/jquery.js"></script>
    <script src="../assets/vendor/libs/popper/popper.js"></script>
    <script src="../assets/vendor/js/bootstrap.js"></script>
    <script src="../assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js"></script>

    <script src="../assets/vendor/js/menu.js"></script>
    <!-- endbuild -->

    <!-- Vendors JS -->
    <script src="../assets/vendor/libs/apex-charts/apexcharts.js"></script>

    <!-- Main JS -->
    <script src="../assets/js/main.js"></script>
    <!-- Page JS -->
    <script src="../assets/js/dashboards-analytics.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Include jsPDF library -->


    <!-- Include required libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            async function generateStyledFinancialReport() {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                const date = new Date().toLocaleDateString('fr-FR');

                // Retrieve saved data
                const savedData = getSavedNonZeroVariables();
                if (!savedData) {
                    alert('No financial data found! Please save data first.');
                    return;
                }

                // Extract values
                const frng = savedData.table1.calculations.frng || 0;
                const bfr = savedData.table1.calculations.bfr || 0;
                const tresorerie = savedData.table1.calculations.tresorerie_nette || 0;
                const roa = savedData.table2.calculations.rentabilite_economique * 100 || 0;
                const roe = savedData.table2.calculations.rentabilite_capt_prop * 100 || 0;
                const autonomie = (savedData.table1.inputs.capitaux_propres /
                    savedData.table1.calculations.total_ressources) * 100 || 0;

                // Set initial position
                let yPos = 30; // Start below header

                // Custom styling functions
                function sectionTitle(title) {
                    doc.setFillColor(200, 220, 255);
                    doc.rect(10, yPos, 190, 8, 'F');
                    doc.setFontSize(12);
                    doc.setFont(undefined, 'bold');
                    doc.text(title, 10, yPos + 6);
                    yPos += 12; // Move down after title
                }

                function ratioAnalysis(ratio, interpretation, recommendation) {
                    doc.setFont(undefined, 'bold');
                    doc.text(ratio, 10, yPos);
                    yPos += 7;

                    doc.setFont(undefined, 'normal');
                    const interpretationLines = doc.splitTextToSize(`Interpr√©tation : ${interpretation}`, 180);
                    doc.text(interpretationLines, 12, yPos);
                    yPos += interpretationLines.length * 6;

                    const recommendationLines = doc.splitTextToSize(`Recommandations : ${recommendation}`, 180);
                    doc.text(recommendationLines, 12, yPos);
                    yPos += recommendationLines.length * 6 + 8;
                }

                // Header
                doc.setFontSize(16);
                doc.setFont(undefined, 'bold');
                doc.text("Rapport d'Analyse Financi√®re", 105, 15, null, null, 'center');

                doc.setFontSize(10);
                doc.setFont(undefined, 'italic');
                doc.text(`Date : ${date}`, 105, 23, null, null, 'center');

                // Section I
                sectionTitle('I. √âquilibres Financiers Fondamentaux');
                ratioAnalysis(
                    `Fonds de Roulement Net Global (FRNG) : ${frng.toLocaleString('fr-FR')} DZ`,
                    "Structure financi√®re saine avec ressources stables suffisantes pour financer les immobilisations. Marge de s√©curit√© financi√®re significative.",
                    "Maintenir cette gestion prudente et utiliser le surplus pour financer le BFR."
                );

                ratioAnalysis(
                    `Besoin en Fonds de Roulement (BFR) : ${bfr.toLocaleString('fr-FR')} DZ`,
                    "Cycle d'exploitation exc√©dentaire g√©n√©rant un surplus de tr√©sorerie.",
                    "Optimiser les d√©lais fournisseurs tout en surveillant les niveaux de stock."
                );

                ratioAnalysis(
                    `Tr√©sorerie Nette : ${tresorerie.toLocaleString('fr-FR')} DZ`,
                    "Excellente capacit√© √† faire face aux engagements √† court terme.",
                    "Investir l'exc√©dent ou le r√©utiliser sans recourir √† l'endettement."
                );

                // Section II
                sectionTitle('II. Performance Op√©rationnelle');
                ratioAnalysis(
                    "D√©lai Clients : 16.66 jours | D√©lai Fournisseurs : 16 jours",
                    "Bon recouvrement, mais am√©lioration possible c√¥t√© fournisseurs.",
                    "N√©gocier des d√©lais plus longs c√¥t√© fournisseurs."
                );

                ratioAnalysis(
                    "BFRE/CA : 1.05%",
                    "Faibles besoins op√©rationnels.",
                    "Viser un BFRE n√©gatif si possible."
                );

                // Section III
                doc.addPage();
                yPos = 30; // Reset position for new page
                sectionTitle('III. Solvabilit√© et Structure Financi√®re');
                ratioAnalysis(
                    `Autonomie Financi√®re : ${autonomie.toFixed(1)}%`,
                    autonomie > 60 ? "Structure de financement robuste." : "Niveau d'autonomie √† am√©liorer.",
                    "Utiliser la marge d'endettement pour investir."
                );

                ratioAnalysis(
                    "Couverture Dettes Financi√®res : 84%",
                    "Endettement √† surveiller.",
                    "Analyser le co√ªt de la dette et renforcer les fonds propres."
                );

                // Section IV
                sectionTitle('IV. Analyse de Liquidit√©');
                ratioAnalysis(
                    "Liquidit√© G√©n√©rale : 2.277",
                    "Solide capacit√© √† couvrir les dettes court terme.",
                    "Poursuivre la bonne gestion actuelle."
                );

                ratioAnalysis(
                    "Liquidit√© R√©duite : 0.057",
                    "Forte d√©pendance aux stocks.",
                    "Am√©liorer la rotation des stocks."
                );

                // Section V
                sectionTitle('V. Performance de Rentabilit√©');
                ratioAnalysis(
                    `ROA : ${roa.toFixed(1)}%`,
                    roa > 20 ? "Tr√®s bonne utilisation des actifs." : "Rentabilit√© des actifs √† am√©liorer.",
                    "Maintenir cette efficacit√©."
                );

                ratioAnalysis(
                    `ROE : ${roe.toFixed(1)}%`,
                    roe > 70 ? "Excellent rendement pour les actionnaires." : "Rendement des capitaux propres acceptable.",
                    "Attirer de nouveaux investisseurs."
                );

                // Section VI
                doc.addPage();
                yPos = 30; // Reset position for new page
                sectionTitle('VI. Synth√®se Strat√©gique et Recommandations');
                yPos += 10;

                doc.setFont(undefined, 'bold');
                doc.text("Points Forts Majeurs :", 10, yPos);
                yPos += 7;

                doc.setFont(undefined, 'normal');
                const strengths = [
                    "- Tr√©sorerie nette positive et FRNG exc√©dentaire",
                    `- Autonomie financi√®re exceptionnelle (${autonomie.toFixed(1)}%)`,
                    "- D√©lais clients tr√®s courts (17 jours)",
                    `- Rentabilit√© financi√®re exceptionnelle (ROE ${roe.toFixed(1)}%)`,
                    "- Structure financi√®re √©quilibr√©e"
                ];

                strengths.forEach(item => {
                    doc.text(item, 12, yPos);
                    yPos += 7;
                });

                yPos += 5;
                doc.setFont(undefined, 'bold');
                doc.text("Points de Vigilance :", 10, yPos);
                yPos += 7;

                doc.setFont(undefined, 'normal');
                const warnings = [
                    "1. Liquidit√© r√©duite (0.057) : D√©pendance excessive aux stocks",
                    "2. D√©lais fournisseurs (16j) : Marge d'am√©lioration par n√©gociation",
                    "3. Couverture des dettes financi√®res (84%) : Analyse co√ªt de la dette n√©cessaire"
                ];

                warnings.forEach(item => {
                    doc.text(item, 12, yPos);
                    yPos += 7;
                });

                yPos += 5;
                doc.setFont(undefined, 'bold');
                doc.text("Plan d'Action Prioritaire :", 10, yPos);
                yPos += 7;

                doc.setFont(undefined, 'normal');
                const actions = [
                    "1. Ren√©gocier les d√©lais paiement fournisseurs (objectif: 30+ jours)",
                    "2. Audit de la gestion des stocks et cr√©ances clients",
                    "3. Analyse d√©taill√©e du co√ªt de l'endettement",
                    "4. Mettre en place des simulations d'investissement",
                    `5. Capitaliser la tr√©sorerie exc√©dentaire (${tresorerie.toLocaleString('fr-FR')} DZ)`
                ];

                actions.forEach(item => {
                    doc.text(item, 12, yPos);
                    yPos += 7;
                });

                yPos += 10;
                doc.setFont(undefined, 'italic');
                const conclusion = doc.splitTextToSize(
                    "Conclusion : Votre entreprise pr√©sente une sant√© financi√®re exceptionnelle avec des fondamentaux solides. " +
                    "Les axes d'optimisation identifi√©s concernent principalement la gestion op√©rationnelle √† court terme et " +
                    "l'optimisation de la structure financi√®re pour pr√©parer la croissance future.",
                    190
                );
                doc.text(conclusion, 10, yPos);

                // Footer on all pages
                const pageCount = doc.internal.getNumberOfPages();
                for (let i = 1; i <= pageCount; i++) {
                    doc.setPage(i);
                    doc.setFont('helvetica', 'italic');
                    doc.setFontSize(8);
                    doc.text(`Page ${i}/${pageCount}`, 105, 287, null, null, 'center');
                }

                // Save PDF
                doc.save(`rapport-financier-${date.replace(/\//g, '-')}.pdf`);
            }

            // Add event listener to your buttox¬≤n
            document.getElementById('submitBtn2').addEventListener('click', generateStyledFinancialReport);
        });
    </script>



    <!-- Add this button to your HTML -->

</body>

</html>